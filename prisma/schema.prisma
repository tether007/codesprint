generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int          @id @default(autoincrement())
  email        String       @unique
  name         String
  passwordHash String       @map("password_hash")
  score        Int          @default(0)
  createdAt    DateTime     @default(now()) @map("created_at")
  submissions  Submission[]

  @@map("users")
}

model Challenge {
  id          Int          @id @default(autoincrement())
  title       String
  description String
  points      Int
  flag        String
  createdAt   DateTime     @default(now()) @map("created_at")
  submissions Submission[]

  @@map("challenges")
}

model Submission {
  id          Int       @id @default(autoincrement())
  userId      Int       @map("user_id")
  challengeId Int       @map("challenge_id")
  isCorrect   Boolean   @map("is_correct")
  submittedAt DateTime  @default(now()) @map("submitted_at")
  challenge   Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, challengeId])
  @@map("submissions")
}
